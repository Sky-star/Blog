## 嵌套 effect

有这样一个需求: effect 是可以嵌套的

```js
effect(function effectFn1() {
	effect(function effectFn2() {
		/* ... */
	})
})
```

在上面这段代码中， effectFn1 内部嵌套了 effectFn2, effectFn1 的执行会导致 effectFn2 的执行。那么什么场景下会出现嵌套 effect 呢？拿 Vue.js 来说， 实际上 Vue.js 的渲染函数就是在一个 effect 中执行的:

```js
// Foo 组件
const Foo = {
	render() {
		return /* .. */
	}
}
```

在一个 effect 中执行 Foo 组件的渲染函数:

```js
effect(() => {
	Foo.render
})
```

在组件发生嵌套时， 例如 Foo 组件渲染了 Bar 组件:

```js
// Bar 组件
const Bar = {
	render() {
		return /* ... */
	}
}

// Foo 组件渲染了 Bar 组件
const Foo = {
	render() {
		return <Bar /> // jsx 语法
	}
}
```

此时就发生了 effect 嵌套， 它相当于:

```js
effect(() => {
	Foo.render()
	// 嵌套
	effect(() => {
		Bar.render()
	})
})
```

这个例子说明了为什么需要 effect 支持可嵌套的。
